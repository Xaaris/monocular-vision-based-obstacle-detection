<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Monocular vision based obstacle detection: mrcnn.model Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Monocular vision based obstacle detection
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacemrcnn.html">mrcnn</a></li><li class="navelem"><a class="el" href="namespacemrcnn_1_1model.html">model</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">mrcnn.model Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmrcnn_1_1model_1_1_batch_norm.html">BatchNorm</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmrcnn_1_1model_1_1_detection_layer.html">DetectionLayer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmrcnn_1_1model_1_1_detection_target_layer.html">DetectionTargetLayer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmrcnn_1_1model_1_1_mask_r_c_n_n.html">MaskRCNN</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classmrcnn_1_1model_1_1_mask_r_c_n_n.html" title="MaskRCNN Class.">MaskRCNN</a> Class.  <a href="classmrcnn_1_1model_1_1_mask_r_c_n_n.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmrcnn_1_1model_1_1_proposal_layer.html">ProposalLayer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmrcnn_1_1model_1_1_pyramid_r_o_i_align.html">PyramidROIAlign</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a06508c330eb9a3825a0ed29bb20e1e31"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a06508c330eb9a3825a0ed29bb20e1e31">log</a> (text, array=None)</td></tr>
<tr class="memdesc:a06508c330eb9a3825a0ed29bb20e1e31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility Functions.  <a href="namespacemrcnn_1_1model.html#a06508c330eb9a3825a0ed29bb20e1e31">More...</a><br /></td></tr>
<tr class="separator:a06508c330eb9a3825a0ed29bb20e1e31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51a0d0b7c2bb36ea9fcda27ece5bfcf1"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a51a0d0b7c2bb36ea9fcda27ece5bfcf1">compute_backbone_shapes</a> (config, image_shape)</td></tr>
<tr class="separator:a51a0d0b7c2bb36ea9fcda27ece5bfcf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ad178f101f31932a8c95148fd80687d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a3ad178f101f31932a8c95148fd80687d">identity_block</a> (input_tensor, kernel_size, filters, stage, block, use_bias=True, train_bn=True)</td></tr>
<tr class="memdesc:a3ad178f101f31932a8c95148fd80687d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resnet Graph.  <a href="namespacemrcnn_1_1model.html#a3ad178f101f31932a8c95148fd80687d">More...</a><br /></td></tr>
<tr class="separator:a3ad178f101f31932a8c95148fd80687d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ee5e0f5d5604fdbdfd6bdc4a9b1ad16"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a6ee5e0f5d5604fdbdfd6bdc4a9b1ad16">conv_block</a> (input_tensor, kernel_size, filters, stage, block, strides=(2, 2), use_bias=True, train_bn=True)</td></tr>
<tr class="separator:a6ee5e0f5d5604fdbdfd6bdc4a9b1ad16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a715fd9043e9afa6f693ca89b29e2a06f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a715fd9043e9afa6f693ca89b29e2a06f">resnet_graph</a> (input_image, architecture, stage5=False, train_bn=True)</td></tr>
<tr class="separator:a715fd9043e9afa6f693ca89b29e2a06f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42d0148ac49a41037ee3aa9eb3a0b833"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a42d0148ac49a41037ee3aa9eb3a0b833">apply_box_deltas_graph</a> (boxes, deltas)</td></tr>
<tr class="memdesc:a42d0148ac49a41037ee3aa9eb3a0b833"><td class="mdescLeft">&#160;</td><td class="mdescRight">Proposal Layer.  <a href="namespacemrcnn_1_1model.html#a42d0148ac49a41037ee3aa9eb3a0b833">More...</a><br /></td></tr>
<tr class="separator:a42d0148ac49a41037ee3aa9eb3a0b833"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30256cb35f044bfc17d6beea3b7ac00a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a30256cb35f044bfc17d6beea3b7ac00a">clip_boxes_graph</a> (boxes, window)</td></tr>
<tr class="separator:a30256cb35f044bfc17d6beea3b7ac00a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a129f44314ba729a4b0f806b3552306"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a8a129f44314ba729a4b0f806b3552306">log2_graph</a> (x)</td></tr>
<tr class="separator:a8a129f44314ba729a4b0f806b3552306"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a884fde5c87c10e300ab35f75aa557fc7"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a884fde5c87c10e300ab35f75aa557fc7">overlaps_graph</a> (boxes1, boxes2)</td></tr>
<tr class="separator:a884fde5c87c10e300ab35f75aa557fc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83e7b2143663d6987e29528353df66ac"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a83e7b2143663d6987e29528353df66ac">detection_targets_graph</a> (proposals, gt_class_ids, gt_boxes, gt_masks, config)</td></tr>
<tr class="separator:a83e7b2143663d6987e29528353df66ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ae9ff03d280d42f82d8048536b6cd58"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a2ae9ff03d280d42f82d8048536b6cd58">refine_detections_graph</a> (rois, probs, deltas, window, config)</td></tr>
<tr class="separator:a2ae9ff03d280d42f82d8048536b6cd58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabe5802fb240986f932a5d4628a27fa5"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#aabe5802fb240986f932a5d4628a27fa5">rpn_graph</a> (feature_map, anchors_per_location, anchor_stride)</td></tr>
<tr class="separator:aabe5802fb240986f932a5d4628a27fa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6af14bdbd6bb1711768d5dcbaf788659"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a6af14bdbd6bb1711768d5dcbaf788659">build_rpn_model</a> (anchor_stride, anchors_per_location, depth)</td></tr>
<tr class="separator:a6af14bdbd6bb1711768d5dcbaf788659"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad1c8d2da318429f2f98036d883b9d35"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#aad1c8d2da318429f2f98036d883b9d35">fpn_classifier_graph</a> (rois, feature_maps, image_meta, pool_size, num_classes, train_bn=True, fc_layers_size=1024)</td></tr>
<tr class="memdesc:aad1c8d2da318429f2f98036d883b9d35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Feature Pyramid Network Heads.  <a href="namespacemrcnn_1_1model.html#aad1c8d2da318429f2f98036d883b9d35">More...</a><br /></td></tr>
<tr class="separator:aad1c8d2da318429f2f98036d883b9d35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a208798c23da50809decb72a1d89e33ec"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a208798c23da50809decb72a1d89e33ec">build_fpn_mask_graph</a> (rois, feature_maps, image_meta, pool_size, num_classes, train_bn=True)</td></tr>
<tr class="separator:a208798c23da50809decb72a1d89e33ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07da8e02d19029910558965f9e919a42"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a07da8e02d19029910558965f9e919a42">smooth_l1_loss</a> (y_true, y_pred)</td></tr>
<tr class="memdesc:a07da8e02d19029910558965f9e919a42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loss Functions.  <a href="namespacemrcnn_1_1model.html#a07da8e02d19029910558965f9e919a42">More...</a><br /></td></tr>
<tr class="separator:a07da8e02d19029910558965f9e919a42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46c04ad93725e5745e73571b91f1ee5e"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a46c04ad93725e5745e73571b91f1ee5e">rpn_class_loss_graph</a> (rpn_match, rpn_class_logits)</td></tr>
<tr class="separator:a46c04ad93725e5745e73571b91f1ee5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab621b50b2b86847cb581e04aefbda683"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#ab621b50b2b86847cb581e04aefbda683">rpn_bbox_loss_graph</a> (config, target_bbox, rpn_match, rpn_bbox)</td></tr>
<tr class="separator:ab621b50b2b86847cb581e04aefbda683"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38bc49d9ec90d51188fdcd0db989071a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a38bc49d9ec90d51188fdcd0db989071a">mrcnn_class_loss_graph</a> (target_class_ids, pred_class_logits, active_class_ids)</td></tr>
<tr class="separator:a38bc49d9ec90d51188fdcd0db989071a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a982ad3f2551557832b5457c8965d4fbd"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a982ad3f2551557832b5457c8965d4fbd">mrcnn_bbox_loss_graph</a> (target_bbox, target_class_ids, pred_bbox)</td></tr>
<tr class="separator:a982ad3f2551557832b5457c8965d4fbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac23962ca1ce5c46a6de91a81b490e3fe"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#ac23962ca1ce5c46a6de91a81b490e3fe">mrcnn_mask_loss_graph</a> (target_masks, target_class_ids, pred_masks)</td></tr>
<tr class="separator:ac23962ca1ce5c46a6de91a81b490e3fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44d7f0d9eed5973973875f6986447889"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a44d7f0d9eed5973973875f6986447889">compose_image_meta</a> (image_id, original_image_shape, image_shape, window, scale, active_class_ids)</td></tr>
<tr class="separator:a44d7f0d9eed5973973875f6986447889"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff70f3f7b8047461d8c054a4db966482"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#aff70f3f7b8047461d8c054a4db966482">parse_image_meta</a> (meta)</td></tr>
<tr class="separator:aff70f3f7b8047461d8c054a4db966482"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fbf3d858da2ef6e50cea652c533e657"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a7fbf3d858da2ef6e50cea652c533e657">parse_image_meta_graph</a> (meta)</td></tr>
<tr class="separator:a7fbf3d858da2ef6e50cea652c533e657"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af555201ae9dc4534940e6af1e9b17f90"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#af555201ae9dc4534940e6af1e9b17f90">mold_image</a> (images, config)</td></tr>
<tr class="separator:af555201ae9dc4534940e6af1e9b17f90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7f3ebaa506ca362ee058fb7ee89877a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#ae7f3ebaa506ca362ee058fb7ee89877a">unmold_image</a> (normalized_images, config)</td></tr>
<tr class="separator:ae7f3ebaa506ca362ee058fb7ee89877a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e77814e3c25de6941638195f8b2467f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a6e77814e3c25de6941638195f8b2467f">trim_zeros_graph</a> (boxes, name=&quot;trim_zeros&quot;)</td></tr>
<tr class="memdesc:a6e77814e3c25de6941638195f8b2467f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Miscellenous Graph Functions.  <a href="namespacemrcnn_1_1model.html#a6e77814e3c25de6941638195f8b2467f">More...</a><br /></td></tr>
<tr class="separator:a6e77814e3c25de6941638195f8b2467f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc5473278b88c3804710d4d184c44cd0"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#acc5473278b88c3804710d4d184c44cd0">batch_pack_graph</a> (x, counts, num_rows)</td></tr>
<tr class="separator:acc5473278b88c3804710d4d184c44cd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac22a0eafe542a71af11e949ccece0917"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#ac22a0eafe542a71af11e949ccece0917">norm_boxes_graph</a> (boxes, shape)</td></tr>
<tr class="separator:ac22a0eafe542a71af11e949ccece0917"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b4b03e47373be4c9cb21ea8649875b4"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemrcnn_1_1model.html#a8b4b03e47373be4c9cb21ea8649875b4">denorm_boxes_graph</a> (boxes, shape)</td></tr>
<tr class="separator:a8b4b03e47373be4c9cb21ea8649875b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Mask R-CNN
The main Mask R-CNN model implementation.

Copyright (c) 2017 Matterport, Inc.
Licensed under the MIT License (see LICENSE for details)
Written by Waleed Abdulla

Adapted by Johannes Berger
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a42d0148ac49a41037ee3aa9eb3a0b833"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42d0148ac49a41037ee3aa9eb3a0b833">&#9670;&nbsp;</a></span>apply_box_deltas_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.apply_box_deltas_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>deltas</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Proposal Layer. </p>
<pre class="fragment">Applies the given deltas to the given boxes.
boxes: [N, (y1, x1, y2, x2)] boxes to update
deltas: [N, (dy, dx, log(dh), log(dw))] refinements to apply
</pre> 
</div>
</div>
<a id="acc5473278b88c3804710d4d184c44cd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc5473278b88c3804710d4d184c44cd0">&#9670;&nbsp;</a></span>batch_pack_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.batch_pack_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>counts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_rows</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Picks different number of values from each row
in x depending on the values in counts.
</pre> 
</div>
</div>
<a id="a208798c23da50809decb72a1d89e33ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a208798c23da50809decb72a1d89e33ec">&#9670;&nbsp;</a></span>build_fpn_mask_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.build_fpn_mask_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rois</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>feature_maps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image_meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pool_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_classes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>train_bn</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Builds the computation graph of the mask head of Feature Pyramid Network.

rois: [batch, num_rois, (y1, x1, y2, x2)] Proposal boxes in normalized
      coordinates.
feature_maps: List of feature maps from different layers of the pyramid,
              [P2, P3, P4, P5]. Each has a different resolution.
image_meta: [batch, (meta data)] Image details. See compose_image_meta()
pool_size: The width of the square feature map generated from ROI Pooling.
num_classes: number of classes, which determines the depth of the results
train_bn: Boolean. Train or freeze Batch Norm layers

Returns: Masks [batch, num_rois, MASK_POOL_SIZE, MASK_POOL_SIZE, NUM_CLASSES]
</pre> 
</div>
</div>
<a id="a6af14bdbd6bb1711768d5dcbaf788659"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6af14bdbd6bb1711768d5dcbaf788659">&#9670;&nbsp;</a></span>build_rpn_model()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.build_rpn_model </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>anchor_stride</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>anchors_per_location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Builds a Keras model of the Region Proposal Network.
It wraps the RPN graph so it can be used multiple times with shared
weights.

anchors_per_location: number of anchors per pixel in the feature map
anchor_stride: Controls the density of anchors. Typically 1 (anchors for
               every pixel in the feature map), or 2 (every other pixel).
depth: Depth of the backbone feature map.

Returns a Keras Model object. The model outputs, when called, are:
rpn_class_logits: [batch, H * W * anchors_per_location, 2] Anchor classifier logits (before softmax)
rpn_probs: [batch, H * W * anchors_per_location, 2] Anchor classifier probabilities.
rpn_bbox: [batch, H * W * anchors_per_location, (dy, dx, log(dh), log(dw))] Deltas to be
            applied to anchors.
</pre> 
</div>
</div>
<a id="a30256cb35f044bfc17d6beea3b7ac00a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30256cb35f044bfc17d6beea3b7ac00a">&#9670;&nbsp;</a></span>clip_boxes_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.clip_boxes_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>window</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">boxes: [N, (y1, x1, y2, x2)]
window: [4] in the form y1, x1, y2, x2
</pre> 
</div>
</div>
<a id="a44d7f0d9eed5973973875f6986447889"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44d7f0d9eed5973973875f6986447889">&#9670;&nbsp;</a></span>compose_image_meta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.compose_image_meta </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>original_image_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>active_class_ids</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Takes attributes of an image and puts them in one 1D array.

image_id: An int ID of the image. Useful for debugging.
original_image_shape: [H, W, C] before resizing or padding.
image_shape: [H, W, C] after resizing and padding
window: (y1, x1, y2, x2) in pixels. The area of the image where the real
        image is (excluding the padding)
scale: The scaling factor applied to the original image (float32)
active_class_ids: List of class_ids available in the dataset from which
    the image came. Useful if training on images from multiple datasets
    where not all classes are present in all datasets.
</pre> 
</div>
</div>
<a id="a51a0d0b7c2bb36ea9fcda27ece5bfcf1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51a0d0b7c2bb36ea9fcda27ece5bfcf1">&#9670;&nbsp;</a></span>compute_backbone_shapes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.compute_backbone_shapes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image_shape</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Computes the width and height of each stage of the backbone network.

Returns:
    [N, (height, width)]. Where N is the number of stages
</pre> 
</div>
</div>
<a id="a6ee5e0f5d5604fdbdfd6bdc4a9b1ad16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ee5e0f5d5604fdbdfd6bdc4a9b1ad16">&#9670;&nbsp;</a></span>conv_block()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.conv_block </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input_tensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>filters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>stage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>strides</em> = <code>(2,&#160;2)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>use_bias</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>train_bn</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">conv_block is the block that has a conv layer at shortcut
# Arguments
    input_tensor: input tensor
    kernel_size: default 3, the kernel size of middle conv layer at main path
    filters: list of integers, the nb_filters of 3 conv layer at main path
    stage: integer, current stage label, used for generating layer names
    block: 'a','b'..., current block label, used for generating layer names
    use_bias: Boolean. To use or not use a bias in conv layers.
    train_bn: Boolean. Train or freeze Batch Norm layers
Note that from stage 3, the first conv layer at main path is with subsample=(2,2)
And the shortcut should have subsample=(2,2) as well
</pre> 
</div>
</div>
<a id="a8b4b03e47373be4c9cb21ea8649875b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b4b03e47373be4c9cb21ea8649875b4">&#9670;&nbsp;</a></span>denorm_boxes_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.denorm_boxes_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shape</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Converts boxes from normalized coordinates to pixel coordinates.
boxes: [..., (y1, x1, y2, x2)] in normalized coordinates
shape: [..., (height, width)] in pixels

Note: In pixel coordinates (y2, x2) is outside the box. But in normalized
coordinates it's inside the box.

Returns:
    [..., (y1, x1, y2, x2)] in pixel coordinates
</pre> 
</div>
</div>
<a id="a83e7b2143663d6987e29528353df66ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83e7b2143663d6987e29528353df66ac">&#9670;&nbsp;</a></span>detection_targets_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.detection_targets_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>proposals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gt_class_ids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gt_boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gt_masks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Generates detection targets for one image. Subsamples proposals and
generates target class IDs, bounding box deltas, and masks for each.

Inputs:
proposals: [POST_NMS_ROIS_TRAINING, (y1, x1, y2, x2)] in normalized coordinates. Might
           be zero padded if there are not enough proposals.
gt_class_ids: [MAX_GT_INSTANCES] int class IDs
gt_boxes: [MAX_GT_INSTANCES, (y1, x1, y2, x2)] in normalized coordinates.
gt_masks: [height, width, MAX_GT_INSTANCES] of boolean type.

Returns: Target ROIs and corresponding class IDs, bounding box shifts,
and masks.
rois: [TRAIN_ROIS_PER_IMAGE, (y1, x1, y2, x2)] in normalized coordinates
class_ids: [TRAIN_ROIS_PER_IMAGE]. Integer class IDs. Zero padded.
deltas: [TRAIN_ROIS_PER_IMAGE, (dy, dx, log(dh), log(dw))]
masks: [TRAIN_ROIS_PER_IMAGE, height, width]. Masks cropped to bbox
       boundaries and resized to neural network output size.

Note: Returned arrays might be zero padded if not enough target ROIs.
</pre> 
</div>
</div>
<a id="aad1c8d2da318429f2f98036d883b9d35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad1c8d2da318429f2f98036d883b9d35">&#9670;&nbsp;</a></span>fpn_classifier_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.fpn_classifier_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rois</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>feature_maps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image_meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pool_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_classes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>train_bn</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fc_layers_size</em> = <code>1024</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Feature Pyramid Network Heads. </p>
<pre class="fragment">Builds the computation graph of the feature pyramid network classifier
and regressor heads.

rois: [batch, num_rois, (y1, x1, y2, x2)] Proposal boxes in normalized
      coordinates.
feature_maps: List of feature maps from different layers of the pyramid,
              [P2, P3, P4, P5]. Each has a different resolution.
image_meta: [batch, (meta data)] Image details. See compose_image_meta()
pool_size: The width of the square feature map generated from ROI Pooling.
num_classes: number of classes, which determines the depth of the results
train_bn: Boolean. Train or freeze Batch Norm layers
fc_layers_size: Size of the 2 FC layers

Returns:
    logits: [batch, num_rois, NUM_CLASSES] classifier logits (before softmax)
    probs: [batch, num_rois, NUM_CLASSES] classifier probabilities
    bbox_deltas: [batch, num_rois, NUM_CLASSES, (dy, dx, log(dh), log(dw))] Deltas to apply to
                 proposal boxes
</pre> 
</div>
</div>
<a id="a3ad178f101f31932a8c95148fd80687d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ad178f101f31932a8c95148fd80687d">&#9670;&nbsp;</a></span>identity_block()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.identity_block </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input_tensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>filters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>stage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>use_bias</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>train_bn</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resnet Graph. </p>
<pre class="fragment">The identity_block is the block that has no conv layer at shortcut
# Arguments
    input_tensor: input tensor
    kernel_size: default 3, the kernel size of middle conv layer at main path
    filters: list of integers, the nb_filters of 3 conv layer at main path
    stage: integer, current stage label, used for generating layer names
    block: 'a','b'..., current block label, used for generating layer names
    use_bias: Boolean. To use or not use a bias in conv layers.
    train_bn: Boolean. Train or freeze Batch Norm layers
</pre> 
</div>
</div>
<a id="a06508c330eb9a3825a0ed29bb20e1e31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06508c330eb9a3825a0ed29bb20e1e31">&#9670;&nbsp;</a></span>log()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.log </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>array</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Utility Functions. </p>
<pre class="fragment">Prints a text message. And, optionally, if a Numpy array is provided it
prints it's shape, min, and max values.
</pre> 
</div>
</div>
<a id="a8a129f44314ba729a4b0f806b3552306"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a129f44314ba729a4b0f806b3552306">&#9670;&nbsp;</a></span>log2_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.log2_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Implementation of Log2. TF doesn't have a native implementation.</pre> 
</div>
</div>
<a id="af555201ae9dc4534940e6af1e9b17f90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af555201ae9dc4534940e6af1e9b17f90">&#9670;&nbsp;</a></span>mold_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.mold_image </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>images</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Expects an RGB image (or array of images) and subtracts
the mean pixel and converts it to float. Expects image
colors in RGB order.
</pre> 
</div>
</div>
<a id="a982ad3f2551557832b5457c8965d4fbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a982ad3f2551557832b5457c8965d4fbd">&#9670;&nbsp;</a></span>mrcnn_bbox_loss_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.mrcnn_bbox_loss_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>target_bbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>target_class_ids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pred_bbox</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Loss for Mask R-CNN bounding box refinement.

target_bbox: [batch, num_rois, (dy, dx, log(dh), log(dw))]
target_class_ids: [batch, num_rois]. Integer class IDs.
pred_bbox: [batch, num_rois, num_classes, (dy, dx, log(dh), log(dw))]
</pre> 
</div>
</div>
<a id="a38bc49d9ec90d51188fdcd0db989071a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38bc49d9ec90d51188fdcd0db989071a">&#9670;&nbsp;</a></span>mrcnn_class_loss_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.mrcnn_class_loss_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>target_class_ids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pred_class_logits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>active_class_ids</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Loss for the classifier head of Mask RCNN.

target_class_ids: [batch, num_rois]. Integer class IDs. Uses zero
    padding to fill in the array.
pred_class_logits: [batch, num_rois, num_classes]
active_class_ids: [batch, num_classes]. Has a value of 1 for
    classes that are in the dataset of the image, and 0
    for classes that are not in the dataset.
</pre> 
</div>
</div>
<a id="ac23962ca1ce5c46a6de91a81b490e3fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac23962ca1ce5c46a6de91a81b490e3fe">&#9670;&nbsp;</a></span>mrcnn_mask_loss_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.mrcnn_mask_loss_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>target_masks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>target_class_ids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pred_masks</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Mask binary cross-entropy loss for the masks head.

target_masks: [batch, num_rois, height, width].
    A float32 tensor of values 0 or 1. Uses zero padding to fill array.
target_class_ids: [batch, num_rois]. Integer class IDs. Zero padded.
pred_masks: [batch, proposals, height, width, num_classes] float32 tensor
            with values from 0 to 1.
</pre> 
</div>
</div>
<a id="ac22a0eafe542a71af11e949ccece0917"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac22a0eafe542a71af11e949ccece0917">&#9670;&nbsp;</a></span>norm_boxes_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.norm_boxes_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shape</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Converts boxes from pixel coordinates to normalized coordinates.
boxes: [..., (y1, x1, y2, x2)] in pixel coordinates
shape: [..., (height, width)] in pixels

Note: In pixel coordinates (y2, x2) is outside the box. But in normalized
coordinates it's inside the box.

Returns:
    [..., (y1, x1, y2, x2)] in normalized coordinates
</pre> 
</div>
</div>
<a id="a884fde5c87c10e300ab35f75aa557fc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a884fde5c87c10e300ab35f75aa557fc7">&#9670;&nbsp;</a></span>overlaps_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.overlaps_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Computes IoU overlaps between two sets of boxes.
boxes1, boxes2: [N, (y1, x1, y2, x2)].
</pre> 
</div>
</div>
<a id="aff70f3f7b8047461d8c054a4db966482"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff70f3f7b8047461d8c054a4db966482">&#9670;&nbsp;</a></span>parse_image_meta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.parse_image_meta </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>meta</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Parses an array that contains image attributes to its components.
See compose_image_meta() for more details.

meta: [batch, meta length] where meta length depends on NUM_CLASSES

Returns a dict of the parsed values.
</pre> 
</div>
</div>
<a id="a7fbf3d858da2ef6e50cea652c533e657"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fbf3d858da2ef6e50cea652c533e657">&#9670;&nbsp;</a></span>parse_image_meta_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.parse_image_meta_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>meta</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Parses a tensor that contains image attributes to its components.
See compose_image_meta() for more details.

meta: [batch, meta length] where meta length depends on NUM_CLASSES

Returns a dict of the parsed tensors.
</pre> 
</div>
</div>
<a id="a2ae9ff03d280d42f82d8048536b6cd58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ae9ff03d280d42f82d8048536b6cd58">&#9670;&nbsp;</a></span>refine_detections_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.refine_detections_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rois</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>probs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>deltas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Refine classified proposals and filter overlaps and return final
detections.

Inputs:
    rois: [N, (y1, x1, y2, x2)] in normalized coordinates
    probs: [N, num_classes]. Class probabilities.
    deltas: [N, num_classes, (dy, dx, log(dh), log(dw))]. Class-specific
            bounding box deltas.
    window: (y1, x1, y2, x2) in normalized coordinates. The part of the image
        that contains the image excluding the padding.

Returns detections shaped: [num_detections, (y1, x1, y2, x2, class_id, score)] where
    coordinates are normalized.
</pre> 
</div>
</div>
<a id="a715fd9043e9afa6f693ca89b29e2a06f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a715fd9043e9afa6f693ca89b29e2a06f">&#9670;&nbsp;</a></span>resnet_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.resnet_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input_image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>architecture</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>stage5</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>train_bn</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Build a ResNet graph.
architecture: Can be resnet50 or resnet101
stage5: Boolean. If False, stage5 of the network is not created
train_bn: Boolean. Train or freeze Batch Norm layers
</pre> 
</div>
</div>
<a id="ab621b50b2b86847cb581e04aefbda683"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab621b50b2b86847cb581e04aefbda683">&#9670;&nbsp;</a></span>rpn_bbox_loss_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.rpn_bbox_loss_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>target_bbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rpn_match</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rpn_bbox</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return the RPN bounding box loss graph.

config: the model config object.
target_bbox: [batch, max positive anchors, (dy, dx, log(dh), log(dw))].
    Uses 0 padding to fill in unsed bbox deltas.
rpn_match: [batch, anchors, 1]. Anchor match type. 1=positive,
           -1=negative, 0=neutral anchor.
rpn_bbox: [batch, anchors, (dy, dx, log(dh), log(dw))]
</pre> 
</div>
</div>
<a id="a46c04ad93725e5745e73571b91f1ee5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46c04ad93725e5745e73571b91f1ee5e">&#9670;&nbsp;</a></span>rpn_class_loss_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.rpn_class_loss_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rpn_match</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rpn_class_logits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">RPN anchor classifier loss.

rpn_match: [batch, anchors, 1]. Anchor match type. 1=positive,
           -1=negative, 0=neutral anchor.
rpn_class_logits: [batch, anchors, 2]. RPN classifier logits for BG/FG.
</pre> 
</div>
</div>
<a id="aabe5802fb240986f932a5d4628a27fa5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabe5802fb240986f932a5d4628a27fa5">&#9670;&nbsp;</a></span>rpn_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.rpn_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>feature_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>anchors_per_location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>anchor_stride</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Builds the computation graph of Region Proposal Network.

feature_map: backbone features [batch, height, width, depth]
anchors_per_location: number of anchors per pixel in the feature map
anchor_stride: Controls the density of anchors. Typically 1 (anchors for
               every pixel in the feature map), or 2 (every other pixel).

Returns:
    rpn_class_logits: [batch, H * W * anchors_per_location, 2] Anchor classifier logits (before softmax)
    rpn_probs: [batch, H * W * anchors_per_location, 2] Anchor classifier probabilities.
    rpn_bbox: [batch, H * W * anchors_per_location, (dy, dx, log(dh), log(dw))] Deltas to be
              applied to anchors.
</pre> 
</div>
</div>
<a id="a07da8e02d19029910558965f9e919a42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07da8e02d19029910558965f9e919a42">&#9670;&nbsp;</a></span>smooth_l1_loss()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.smooth_l1_loss </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y_true</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y_pred</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loss Functions. </p>
<pre class="fragment">Implements Smooth-L1 loss.
y_true and y_pred are typically: [N, 4], but could be any shape.
</pre> 
</div>
</div>
<a id="a6e77814e3c25de6941638195f8b2467f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e77814e3c25de6941638195f8b2467f">&#9670;&nbsp;</a></span>trim_zeros_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.trim_zeros_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>name</em> = <code>&quot;trim_zeros&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Miscellenous Graph Functions. </p>
<pre class="fragment">Often boxes are represented with matrices of shape [N, 4] and
are padded with zeros. This removes zero boxes.

boxes: [N, 4] matrix of boxes.
non_zeros: [N] a 1D boolean mask identifying the rows to keep
</pre> 
</div>
</div>
<a id="ae7f3ebaa506ca362ee058fb7ee89877a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7f3ebaa506ca362ee058fb7ee89877a">&#9670;&nbsp;</a></span>unmold_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def mrcnn.model.unmold_image </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>normalized_images</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Takes a image normalized with mold() and returns the original.</pre> 
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
